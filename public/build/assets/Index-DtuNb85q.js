import{j as e}from"./app-BrpLVVx-.js";import{u as I,r as c,b as L,H as q,d as w}from"./inertia-Clk-cdek.js";import{D as Y}from"./DirectorLayout-CcGb8YMq.js";import{t as C,u as _,l as S,v as A,w as B,x as H,y as G,z as $,A as g,B as o}from"./heroicons-CTwCrMww.js";import"./vendor-DNWpyu2A.js";/* empty css            */import"./Footer-COinO4S5.js";import"./menu-BcEDE3vj.js";import"./portal-CZK08gWH.js";import"./transition-Cw_pkg33.js";function ae({currentYear:l,pastYears:N,auth:U}){const{flash:u}=I().props,[F,f]=c.useState(!1),[R,E]=c.useState("");c.useEffect(()=>{u?.success&&(E(u.success),f(!0),setTimeout(()=>f(!1),5e3))},[u]);const[T,m]=c.useState(!1),[v,O]=c.useState(null),{data:x,setData:h,post:D,processing:y,errors:d,reset:M}=L({name:"",start_date:"",end_date:"",set_as_current:!0}),z=s=>{s.preventDefault(),D(route("director.academic-years.store"),{onSuccess:()=>{m(!1),M()}})},p=(s,a,r)=>{confirm(`Are you sure you want to ${a==="open"?"OPEN":"CLOSE"} Semester ${s}? This will affect all grades.`)&&w.post(route("director.academic-years.toggle-semester"),{semester:s,action:a,academic_year_id:r})},P=s=>{O(v===s?null:s)},b=({status:s})=>{const a={open:"bg-gradient-to-r from-emerald-500 to-green-500 text-white ring-emerald-600 shadow-lg shadow-emerald-200 animate-pulse",closed:"bg-gradient-to-r from-red-500 to-rose-500 text-white ring-red-600 shadow-md shadow-red-200",active:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white ring-blue-600 shadow-lg shadow-blue-200",inactive:"bg-gradient-to-r from-gray-400 to-gray-500 text-white ring-gray-600 shadow-md",planned:"bg-gradient-to-r from-amber-400 to-orange-400 text-white ring-amber-600 shadow-md shadow-amber-200",completed:"bg-gradient-to-r from-purple-500 to-violet-500 text-white ring-purple-600 shadow-md shadow-purple-200"},r=a[s]||a.inactive;return e.jsx("span",{className:`inline-flex items-center rounded-full px-4 py-1.5 text-xs font-bold ring-2 ring-inset ${r} transition-all uppercase tracking-wide`,children:s})},k=({number:s,statusData:a,yearId:r,isCurrent:i})=>{if(!a)return null;const t=a.status==="open",n=a.can_open,j=!i;return e.jsxs("div",{className:`flex flex-col border rounded-lg shadow-sm transition-all duration-300 ${t?"bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-400 ring-4 ring-emerald-100 shadow-emerald-200":"bg-gradient-to-br from-red-50 to-rose-50 border-red-300 ring-2 ring-red-100 shadow-red-100"}`,children:[e.jsxs("div",{className:`p-5 border-b flex justify-between items-start ${t?"border-emerald-200 bg-white/50":"border-red-200 bg-white/50"}`,children:[e.jsxs("div",{children:[e.jsxs("h4",{className:`text-sm font-semibold uppercase tracking-wide ${t?"text-emerald-700":"text-red-700"}`,children:["Semester ",s]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(b,{status:a.status}),t&&e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-bold text-emerald-700",children:[e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-500 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-emerald-600"})]}),"Accepting Marks"]}),!t&&e.jsxs("span",{className:"flex items-center gap-1.5 text-sm font-bold text-red-700",children:[e.jsx(o,{className:"h-4 w-4"}),"Locked"]})]})]}),t?e.jsx(g,{className:"w-8 h-8 text-emerald-600"}):e.jsx(o,{className:"w-8 h-8 text-red-600"})]}),e.jsx("div",{className:"p-4 bg-gray-50/50 rounded-b-lg flex-1 flex flex-col gap-3",children:t?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s===2&&i?"Closing will calculate yearly results and AUTO-CREATE the next academic year.":"Closing will calculate results for this period and lock mark entry."}),e.jsxs("button",{onClick:()=>p(s,"close",r),className:"w-full inline-flex justify-center items-center gap-x-1.5 rounded-md bg-gradient-to-r from-red-500 to-rose-500 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-red-200 hover:from-red-600 hover:to-rose-600 transition-all",children:[e.jsx(o,{className:"-ml-0.5 h-4 w-4","aria-hidden":"true"}),"Close Period"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-xs text-gray-500",children:j?"Reopening an archived semester allows teachers to correct historical marks.":n?"Opening access allows teachers to start declaring results.":"Semester 1 must be closed before opening Semester 2."}),e.jsx("button",{onClick:()=>p(s,"open",r),disabled:!n,className:`w-full inline-flex justify-center items-center gap-x-1.5 rounded-md px-3 py-2 text-sm font-semibold shadow-lg transition-all ${n?j?"bg-gradient-to-r from-amber-500 to-orange-500 text-white shadow-amber-200 hover:from-amber-600 hover:to-orange-600":"bg-gradient-to-r from-emerald-500 to-green-500 text-white shadow-emerald-200 hover:from-emerald-600 hover:to-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed shadow-none"}`,children:j?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"-ml-0.5 h-4 w-4"})," Reopen for Edits"]}):n?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"-ml-0.5 h-4 w-4"})," Open Access"]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"-ml-0.5 h-4 w-4"})," Locked"]})})]})})]})};return e.jsxs(Y,{children:[e.jsx(q,{title:"Academic Year Management"}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight",children:"Academic Management"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Manage academic calendars, control semester access, and view historical archives."})]}),e.jsx("div",{className:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none",children:e.jsx("button",{type:"button",onClick:()=>m(!0),className:"block rounded-md bg-slate-800 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-slate-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-600",children:"Create Academic Year"})})]}),e.jsxs("div",{className:"mt-8 space-y-8",children:[e.jsx("section",{"aria-labelledby":"active-year-heading",children:e.jsxs("div",{className:"rounded-lg bg-white shadow-sm ring-1 ring-gray-900/5",children:[e.jsxs("div",{className:"border-b border-gray-200 px-4 py-5 sm:px-6 flex justify-between items-center bg-gray-50/50 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-slate-600",children:e.jsx(C,{className:"h-6 w-6 text-white","aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx("h2",{id:"active-year-heading",className:"text-lg font-semibold leading-6 text-gray-900",children:"Current Academic Year"}),e.jsx("p",{className:"mt-1 flex items-center text-sm text-gray-500",children:e.jsx("span",{className:"truncate",children:l?l.name:"No Active Year"})})]})]}),l&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"inline-flex items-center rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 px-4 py-2 text-sm font-bold text-white shadow-lg shadow-blue-200 animate-pulse",children:"✓ Active Cycle"}),e.jsxs("button",{onClick:()=>{confirm(`Deactivate "${l.name}"? This will make it inactive.`)&&w.post(route("director.academic-years.set-current",l.id))},className:"inline-flex items-center gap-x-1.5 rounded-md bg-gradient-to-r from-red-500 to-rose-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-red-200 hover:from-red-600 hover:to-rose-600 transition-all",children:[e.jsx(_,{className:"h-4 w-4"}),"Deactivate"]})]})]}),l?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8",children:[e.jsx("div",{className:"col-span-1 md:col-span-2 bg-slate-900 text-white p-5 rounded-xl shadow-lg border border-slate-700",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 bg-slate-800 rounded-lg p-2",children:e.jsx(S,{className:"h-6 w-6 text-emerald-400","aria-hidden":"true"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-md font-bold text-white uppercase tracking-wider",children:"Automated Progression Rule"}),e.jsxs("p",{className:"mt-1 text-sm text-slate-300 leading-relaxed",children:["The workflow is fully automated for efficiency:",e.jsx("span",{className:"block mt-1 font-semibold text-emerald-400",children:"S1 Close → S2 Opens Automatically | S2 Close → Year Archives & Next Year Starts"})]})]})]})}),e.jsx(k,{number:1,statusData:l.semesters[1],yearId:l.id,isCurrent:!0}),e.jsx(k,{number:2,statusData:l.semesters[2],yearId:l.id,isCurrent:!0})]}),e.jsx("div",{className:"mt-6 border-t border-gray-100 pt-4",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(A,{className:"mr-1.5 h-4 w-4 flex-shrink-0 text-gray-400"}),"Duration: ",e.jsxs("span",{className:"font-medium text-gray-900 ml-1",children:[l.start_date," - ",l.end_date]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No active academic year"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new academic cycle."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",onClick:()=>m(!0),className:"inline-flex items-center rounded-md bg-slate-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-600",children:[e.jsx(H,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),"Initialize Year"]})})]})]})}),e.jsxs("section",{"aria-labelledby":"history-heading",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{id:"history-heading",className:"text-base font-semibold leading-6 text-gray-900",children:"Archives"})}),e.jsx("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm ring-1 ring-gray-900/5",children:e.jsx("ul",{role:"list",className:"divide-y divide-gray-100",children:N.length>0?N.map(s=>{const a=v===s.id;return e.jsx("li",{className:"transition hover:bg-gray-50",children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>P(s.id),children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded bg-gray-100 text-gray-500",children:e.jsx(A,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:s.name}),e.jsxs("p",{className:"truncate text-xs leading-5 text-gray-500",children:[s.start_date," to ",s.end_date]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{status:s.status}),e.jsx(G,{className:`h-5 w-5 text-gray-400 transform transition-transform ${a?"rotate-180":""}`})]})]}),a&&e.jsxs("div",{className:"mt-4 pl-14 pr-2 pb-2 border-t border-gray-100 pt-4",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:r=>{r.stopPropagation(),confirm(`Activate "${s.name}"? This will make it the current active year.`)&&w.post(route("director.academic-years.set-current",s.id))},className:"inline-flex items-center gap-x-1.5 rounded-md bg-gradient-to-r from-emerald-500 to-green-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-200 hover:from-emerald-600 hover:to-green-600 transition-all",children:[e.jsx($,{className:"w-4 h-4"}),"Activate Year"]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[1,2].map(r=>{const i=s.semesterStatuses?.find(n=>n.semester===r),t=i?.status==="open";return e.jsxs("div",{className:`rounded-lg border p-4 flex items-center justify-between transition-all ${t?"bg-gradient-to-br from-emerald-50 to-green-50 border-emerald-300 shadow-md shadow-emerald-100":"bg-gradient-to-br from-red-50 to-rose-50 border-red-300 shadow-sm shadow-red-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t?e.jsx(g,{className:"w-5 h-5 text-emerald-600"}):e.jsx(o,{className:"w-5 h-5 text-red-600"}),e.jsxs("span",{className:`text-sm font-semibold ${t?"text-emerald-700":"text-red-700"}`,children:["Semester ",r]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{status:i?.status||"closed"}),e.jsx("button",{onClick:()=>p(r,i?.status==="open"?"close":"open",s.id),className:`p-1.5 rounded-md transition-all ${t?"text-red-600 hover:bg-red-100":"text-emerald-600 hover:bg-emerald-100"}`,title:t?"Close semester":"Open semester",children:t?e.jsx(o,{className:"w-5 h-5"}):e.jsx(g,{className:"w-5 h-5"})})]})]},r)})})]})]})},s.id)}):e.jsx("li",{className:"px-4 py-8 text-center text-sm text-gray-500",children:"No archived records found."})})})]})]}),T&&e.jsxs("div",{className:"relative z-50","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"}),e.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsx("div",{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-slate-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(C,{className:"h-6 w-6 text-slate-600","aria-hidden":"true"})}),e.jsxs("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full",children:[e.jsx("h3",{className:"text-base font-semibold leading-6 text-gray-900",id:"modal-title",children:"Create Academic Year"}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Year Name"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{type:"text",className:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-slate-600 sm:text-sm sm:leading-6",placeholder:"e.g. 2026-2027",value:x.name,onChange:s=>h("name",s.target.value),required:!0}),d.name&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.name})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"Start Date"}),e.jsx("input",{type:"date",className:"mt-1 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-slate-600 sm:text-sm sm:leading-6",value:x.start_date,onChange:s=>h("start_date",s.target.value),required:!0}),d.start_date&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.start_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium leading-6 text-gray-900",children:"End Date"}),e.jsx("input",{type:"date",className:"mt-1 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-slate-600 sm:text-sm sm:leading-6",value:x.end_date,onChange:s=>h("end_date",s.target.value),required:!0}),d.end_date&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.end_date})]})]}),e.jsxs("div",{className:"relative flex gap-x-3",children:[e.jsx("div",{className:"flex h-6 items-center",children:e.jsx("input",{id:"set_current",name:"set_current",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-slate-600 focus:ring-slate-600",checked:x.set_as_current,onChange:s=>h("set_as_current",s.target.checked)})}),e.jsxs("div",{className:"text-sm leading-6",children:[e.jsx("label",{htmlFor:"set_current",className:"font-medium text-gray-900",children:"Set as Current Year"}),e.jsx("p",{className:"text-gray-500",children:"Automatically deactivate other years."})]})]}),e.jsxs("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"submit",disabled:y,className:"inline-flex w-full justify-center rounded-md bg-slate-800 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-slate-700 sm:ml-3 sm:w-auto",children:y?"Creating...":"Create"}),e.jsx("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>m(!1),children:"Cancel"})]})]})})]})]})})})})]}),F&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 animate-in slide-in-from-bottom-5 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 bg-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl shadow-emerald-900/50 ring-2 ring-emerald-400 min-w-[320px]",children:[e.jsx($,{className:"h-6 w-6 flex-shrink-0"}),e.jsx("p",{className:"text-sm font-semibold flex-1",children:R}),e.jsx("button",{onClick:()=>f(!1),className:"text-white/80 hover:text-white transition-colors",children:e.jsx(_,{className:"h-5 w-5"})})]})})]})]})}export{ae as default};
