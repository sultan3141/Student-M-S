import{j as e}from"./app-BnMRzgve.js";import{r as h,b as E,H as $}from"./inertia-Clk-cdek.js";import{T as F}from"./TeacherLayout-C0Nq8xUd.js";import{P as M}from"./PrimaryButton-DpEX65Zs.js";import{S as T}from"./SecondaryButton-MmRRKrij.js";import{T as w,I as R}from"./TextInput-CFQNNfBP.js";import{G as A,z as p,m as b,g as D,J as V,ac as B}from"./heroicons-CTwCrMww.js";import"./vendor-DNWpyu2A.js";/* empty css            */import"./Footer-DA3Ujf7w.js";import"./ErrorBoundary-COWBsaKZ.js";import"./menu-BcEDE3vj.js";import"./portal-CZK08gWH.js";import"./transition-Cw_pkg33.js";function se({assessment:l,students:o}){const[c,u]=h.useState({}),[I,P]=h.useState(null),[m,f]=h.useState("cards"),{data:H,setData:y,post:S,processing:j,errors:k}=E({marks:[]});h.useEffect(()=>{const t={};o.forEach(s=>{t[s.id]={student_id:s.id,component_scores:l.components.reduce((a,r)=>(a[r.id]=s.component_scores[r.id]||"",a),{}),total_score:s.total_score||0}}),u(t)},[o,l.components]);const x=t=>{const s=c[t];if(!s)return 0;let a=0;return l.components.forEach(r=>{const n=(parseFloat(s.component_scores[r.id])||0)*r.max_weight/100;a+=n}),Math.round(a*100)/100},v=(t,s,a)=>{const r={...c};r[t]||(r[t]={student_id:t,component_scores:{},total_score:0}),r[t].component_scores[s]=a,r[t].total_score=x(t),u(r)},_=t=>{const s=parseFloat(t);return!isNaN(s)&&s>=0&&s<=100},g=t=>{const s=c[t];if(!s)return"incomplete";let a=!0,r=!0;return l.components.forEach(d=>{const n=s.component_scores[d.id];!n||n===""?a=!1:_(n)||(r=!1)}),a?r?"complete":"invalid":"incomplete"},N=t=>t>=90?"text-emerald-600 bg-emerald-50":t>=80?"text-blue-600 bg-blue-50":t>=70?"text-yellow-600 bg-yellow-50":t>=60?"text-orange-600 bg-orange-50":"text-red-600 bg-red-50",C=t=>{t.preventDefault();const s=Object.values(c).map(a=>({...a,total_score:x(a.student_id)}));y("marks",s),S(route("teacher.custom-assessments.store-marks",l.id))},i=(()=>{let t=0,s=0,a=0;return o.forEach(r=>{const d=g(r.id);d==="complete"?t++:d==="invalid"?a++:s++}),{complete:t,incomplete:s,invalid:a,total:o.length}})();return e.jsxs(F,{children:[e.jsx($,{title:`Enter Marks - ${l.name}`}),e.jsxs("div",{className:"relative bg-gradient-to-br from-indigo-600 via-purple-600 to-blue-700 shadow-2xl mb-8 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-12 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/5 backdrop-blur-sm",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})}),e.jsxs("div",{className:"relative max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm",children:e.jsx(A,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-white tracking-tight mb-2",children:"ðŸ“Š Enter Student Marks"}),e.jsxs("p",{className:"text-indigo-100 text-lg",children:[l.name," â€¢ ",l.subject_name," â€¢ ",l.section_name]})]})]}),e.jsxs("div",{className:"hidden md:flex bg-white/20 backdrop-blur-sm rounded-xl p-1",children:[e.jsx("button",{onClick:()=>f("cards"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m==="cards"?"bg-white text-indigo-600 shadow-lg":"text-white hover:bg-white/20"}`,children:"Card View"}),e.jsx("button",{onClick:()=>f("table"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m==="table"?"bg-white text-indigo-600 shadow-lg":"text-white hover:bg-white/20"}`,children:"Table View"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl p-4 text-center border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(p,{className:"w-6 h-6 text-emerald-300 mr-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:i.complete})]}),e.jsx("div",{className:"text-indigo-100 text-sm font-medium",children:"Complete"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl p-4 text-center border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(b,{className:"w-6 h-6 text-yellow-300 mr-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:i.incomplete})]}),e.jsx("div",{className:"text-indigo-100 text-sm font-medium",children:"Incomplete"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl p-4 text-center border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(b,{className:"w-6 h-6 text-red-300 mr-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:i.invalid})]}),e.jsx("div",{className:"text-indigo-100 text-sm font-medium",children:"Invalid"})]}),e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-2xl p-4 text-center border border-white/30",children:[e.jsxs("div",{className:"flex items-center justify-center mb-2",children:[e.jsx(D,{className:"w-6 h-6 text-blue-300 mr-2"}),e.jsx("div",{className:"text-3xl font-bold text-white",children:i.total})]}),e.jsx("div",{className:"text-indigo-100 text-sm font-medium",children:"Total Students"})]})]})]})]}),e.jsxs("form",{onSubmit:C,className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(V,{className:"w-5 h-5 mr-2 text-blue-600"}),"Assessment Components"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:l.components.map(t=>e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:t.name}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[t.max_weight,"%"]})]}),t.description&&e.jsx("p",{className:"text-blue-700 text-sm",children:t.description})]},t.id))})})]}),m==="cards"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:o.map(t=>{const s=g(t.id),a=x(t.id);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:`px-6 py-4 ${s==="complete"?"bg-gradient-to-r from-emerald-50 to-green-50 border-b border-emerald-200":s==="invalid"?"bg-gradient-to-r from-red-50 to-pink-50 border-b border-red-200":"bg-gradient-to-r from-gray-50 to-blue-50 border-b border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",t.student_id]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-2xl font-bold px-3 py-1 rounded-lg ${N(a)}`,children:[a.toFixed(1),"%"]}),s==="complete"&&e.jsx(p,{className:"w-6 h-6 text-emerald-500 mx-auto mt-1"}),s==="invalid"&&e.jsx(b,{className:"w-6 h-6 text-red-500 mx-auto mt-1"})]})]})}),e.jsx("div",{className:"p-6 space-y-4",children:l.components.map(r=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:r.name}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[r.max_weight,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(w,{type:"number",min:"0",max:"100",step:"0.1",value:c[t.id]?.component_scores[r.id]||"",onChange:d=>v(t.id,r.id,d.target.value),className:"w-full text-center text-lg font-semibold border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-indigo-500 transition-colors",placeholder:"0-100"}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm",children:"/100"})]})]},r.id))})]},t.id)})}),m==="table"&&e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 border-b border-gray-200",children:"Student"}),l.components.map(t=>e.jsxs("th",{className:"px-4 py-4 text-center text-sm font-semibold text-gray-900 border-b border-gray-200",children:[e.jsx("div",{children:t.name}),e.jsxs("div",{className:"text-xs text-blue-600 font-normal",children:["(",t.max_weight,"%)"]})]},t.id)),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900 border-b border-gray-200",children:"Total Score"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900 border-b border-gray-200",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:o.map(t=>{const s=g(t.id),a=x(t.id);return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",t.student_id]})]})]})}),l.components.map(r=>e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx(w,{type:"number",min:"0",max:"100",step:"0.1",value:c[t.id]?.component_scores[r.id]||"",onChange:d=>v(t.id,r.id,d.target.value),className:"w-20 text-center border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:ring-indigo-500",placeholder:"0-100"})},r.id)),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-lg font-bold ${N(a)}`,children:[a.toFixed(1),"%"]})}),e.jsxs("td",{className:"px-6 py-4 text-center",children:[s==="complete"&&e.jsx(p,{className:"w-6 h-6 text-emerald-500 mx-auto"}),s==="invalid"&&e.jsx(b,{className:"w-6 h-6 text-red-500 mx-auto"}),s==="incomplete"&&e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full mx-auto"})]})]},t.id)})})]})})}),e.jsx(R,{message:k.marks,className:"mt-2"}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(T,{type:"button",onClick:()=>window.history.back(),className:"px-6 py-3",children:"Cancel"})}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Progress"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[i.complete," of ",i.total," students complete"]}),e.jsx("div",{className:"w-48 bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${i.complete/i.total*100}%`}})})]}),e.jsx(M,{type:"submit",disabled:j||i.complete===0,className:"px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-lg font-semibold shadow-lg",children:j?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Save All Marks"]})})]})]})})]})]})}export{se as default};
